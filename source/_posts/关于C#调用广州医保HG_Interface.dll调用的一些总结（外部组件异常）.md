---
title: 关于.Net 调用广州医保HG_Interface.dll调用的一些总结（外部组件异常）
tags:
  - 广州医保
  - HG_Interface.dll
  - 外部组件异常
  - 'C#'
abbrlink: 57100
date: 2017-01-21 10:01:06
categories:
  - 踩坑笔记
---
 开始做的时候也遇到了奇葩的情况、创智提供的dll只能在有UI的Winform、WPF上使用，WebForm、WPF、WebService完全没办法使用，Console在加上了[STAThread]的线程Attribute之后也可以成功调用，推测和dll使用MFC编写有关、但是各种引入MFC的dll均无果，一筹莫展之际把问题提到了交流群里，吾乐吧的牛总给出了可行的解决方案----使用WCF来调用。

有了具体解决方案一切就顺风顺水了，但是完成程序之后又出现了奇葩的问题，部署到服务器也会出现外部组件异常的问题，本机调试可以部署却不行，很明显就是环境的问题了，由于dll为非托管dll，我们无法从错误中得到有效的错误信息，从环境下手尝试解决，虽然最终成功了，但是目前还并不清楚到底是因为什么，这里的经验是MSSOAP、MSXML、WebMatrix一定要装，如果还是不能成功运行可以考虑安装VS环境试试看。期待能有高手给出具体的解决之道。
<!-- more -->
